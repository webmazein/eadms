import{r as l,q as G,j as e,L as J}from"./index-D5mK4_IJ.js";import{B as K,C as U,Q as W}from"./ReactToastify-BKZpGq8X.js";import{A as X}from"./ApiService-BesEYMem.js";import{C as Y,a as Z}from"./CRow-DEPKtvaT.js";import{C as $,a as ee}from"./config-JwZ8C9zi.js";import{a as se}from"./index.es-BSy7osIh.js";import{C as ae,a as ne,b as R,c as o,d as ce,e as r}from"./CTable-9aaG2jHs.js";const xe=()=>{const[x,k]=l.useState([]),[u,T]=l.useState([]),[n,v]=l.useState(null),[t,f]=l.useState("asc"),[g,D]=l.useState(1),[m]=l.useState(5),[i,E]=l.useState(""),I=G();l.useEffect(()=>{P()},[]),l.useEffect(()=>{F(),console.log(x,"Report response")},[x,n,t,g,i]);const P=async()=>{try{const s=await X.request("get","/raise_defects/defectsReport",null,{},I);k(s.data.map(c=>({...c,raisedBy:c.user,raisedAt:c.updated_at})))}catch(s){console.error("Error fetching data:",s),K.error("Failed to fetch reports")}},F=()=>{let s=[...x];i.trim()!==""&&(s=s.filter(a=>{var w,_,y,L,S,N,p,B,b,A;const h=((w=a==null?void 0:a.engine_serial_no)==null?void 0:w.toLowerCase())||"",C=((_=a==null?void 0:a.defects)==null?void 0:_.toLowerCase())||"",j=((y=a==null?void 0:a.actions)==null?void 0:y.toLowerCase())||"",q=((L=a==null?void 0:a.operator_name)==null?void 0:L.toLowerCase())||"",V=((N=(S=a==null?void 0:a.station_id)==null?void 0:S.toString())==null?void 0:N.toLowerCase())||"",M=((B=(p=a==null?void 0:a.screen_no)==null?void 0:p.toString())==null?void 0:B.toLowerCase())||"",Q=((b=a==null?void 0:a.raisedBy)==null?void 0:b.toLowerCase())||"",z=((A=a==null?void 0:a.raisedAt)==null?void 0:A.toLowerCase())||"";return h.includes(i.toLowerCase())||C.includes(i.toLowerCase())||j.includes(i.toLowerCase())||q.includes(i.toLowerCase())||V.includes(i.toLowerCase())||M.includes(i.toLowerCase())||Q.includes(i.toLowerCase())||z.includes(i.toLowerCase())})),n&&s.sort((a,h)=>{const C=typeof a[n]=="string"?a[n].toLowerCase():a[n],j=typeof h[n]=="string"?h[n].toLowerCase():h[n];return t==="asc"?C>j?1:-1:C<j?1:-1});const c=(g-1)*m,O=c+m;s=s.slice(c,O),T(s)},d=s=>{s===n?f(t==="asc"?"desc":"asc"):(v(s),f("asc"))},H=s=>D(s);return e.jsxs(Y,{children:[e.jsx(Z,{xs:12,children:e.jsxs($,{className:"mb-4",children:[e.jsxs(U,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Reports"}),e.jsx(J,{to:"/raiseDefects",children:e.jsx(se,{color:"primary",children:"Add New +"})})]}),e.jsxs(ee,{children:[e.jsx("div",{className:"d-flex justify-content-between mb-3",children:e.jsx("input",{type:"text",placeholder:"Search...",value:i,onChange:s=>E(s.target.value)})}),e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs(R,{children:[e.jsx(o,{scope:"col",children:"#"}),e.jsxs(o,{scope:"col",onClick:()=>d("engine_serial_no"),children:["Engine Serial No"," ",n==="engine_serial_no"&&e.jsx("span",{children:t==="asc"?"▲":"▼"})]}),e.jsxs(o,{scope:"col",onClick:()=>d("defects"),children:["Defect ",n==="defects"&&e.jsx("span",{children:t==="asc"?"▲":"▼"})]}),e.jsxs(o,{scope:"col",onClick:()=>d("actions"),children:["Actions ",n==="actions"&&e.jsx("span",{children:t==="asc"?"▲":"▼"})]}),e.jsxs(o,{scope:"col",onClick:()=>d("operator_name"),children:["Operator Name"," ",n==="operator_name"&&e.jsx("span",{children:t==="asc"?"▲":"▼"})]}),e.jsxs(o,{scope:"col",onClick:()=>d("station_id"),children:["Station ID"," ",n==="station_id"&&e.jsx("span",{children:t==="asc"?"▲":"▼"})]}),e.jsxs(o,{scope:"col",onClick:()=>d("screen_id"),children:["Screen No"," ",n==="screen_id"&&e.jsx("span",{children:t==="asc"?"▲":"▼"})]}),e.jsxs(o,{scope:"col",onClick:()=>d("raisedBy"),children:["Raised By"," ",n==="raisedBy"&&e.jsx("span",{children:t==="asc"?"▲":"▼"})]}),e.jsxs(o,{scope:"col",onClick:()=>d("raisedAt"),children:["Raised At"," ",n==="raisedAt"&&e.jsx("span",{children:t==="asc"?"▲":"▼"})]})]})}),e.jsx(ce,{children:u.length>0&&u.map((s,c)=>e.jsxs(R,{children:[e.jsx(o,{scope:"row",children:c+1}),e.jsx(r,{children:s.engine_serial_no}),e.jsx(r,{children:s.defect_name}),e.jsx(r,{children:s.actions}),e.jsx(r,{children:s.operator_name}),e.jsx(r,{children:s.station_id}),e.jsx(r,{children:s.screen_no}),e.jsx(r,{children:s.raisedBy}),e.jsx(r,{children:s.raisedAt})]},s.id))})]}),e.jsx("nav",{children:e.jsx("ul",{className:"pagination",children:Array.from({length:Math.ceil(x.length/m)}).map((s,c)=>e.jsx("li",{className:"page-item",children:e.jsx("button",{onClick:()=>H(c+1),className:"page-link",children:c+1})},c))})})]})]})}),e.jsx(W,{})]})};export{xe as default};
