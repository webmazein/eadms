import{y as h,r as N,e as Ne,z as Ce,B as pe,m as we,k as Ae,D as Ie,E as re,j as b}from"./index-D5mK4_IJ.js";import{w as ke,C as Me,a as Pe,b as de,c as ve}from"./config-JwZ8C9zi.js";import{C as De,a as Le}from"./CRow-DEPKtvaT.js";import{C as je,d as We,b as ne,c as ae,e as W}from"./CTable-9aaG2jHs.js";var be={},U={},C={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isEventSourceSupported=e.isReactNative=e.ReadyState=e.DEFAULT_HEARTBEAT=e.UNPARSABLE_JSON_OBJECT=e.DEFAULT_RECONNECT_INTERVAL_MS=e.DEFAULT_RECONNECT_LIMIT=e.SOCKET_IO_PING_CODE=e.SOCKET_IO_PATH=e.SOCKET_IO_PING_INTERVAL=e.DEFAULT_EVENT_SOURCE_OPTIONS=e.EMPTY_EVENT_HANDLERS=e.DEFAULT_OPTIONS=void 0;var t=1,r=1e3*t;e.DEFAULT_OPTIONS={},e.EMPTY_EVENT_HANDLERS={},e.DEFAULT_EVENT_SOURCE_OPTIONS={withCredentials:!1,events:e.EMPTY_EVENT_HANDLERS},e.SOCKET_IO_PING_INTERVAL=25*r,e.SOCKET_IO_PATH="/socket.io/?EIO=3&transport=websocket",e.SOCKET_IO_PING_CODE="2",e.DEFAULT_RECONNECT_LIMIT=20,e.DEFAULT_RECONNECT_INTERVAL_MS=5e3,e.UNPARSABLE_JSON_OBJECT={},e.DEFAULT_HEARTBEAT={message:"ping",timeout:6e4,interval:25e3},function(a){a[a.UNINSTANTIATED=-1]="UNINSTANTIATED",a[a.CONNECTING=0]="CONNECTING",a[a.OPEN=1]="OPEN",a[a.CLOSING=2]="CLOSING",a[a.CLOSED=3]="CLOSED"}(e.ReadyState||(e.ReadyState={}));var n=function(){try{return"EventSource"in globalThis}catch{return!1}};e.isReactNative=typeof navigator<"u"&&navigator.product==="ReactNative",e.isEventSourceSupported=!e.isReactNative&&n()})(C);var Q={},Y={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.resetWebSockets=e.sharedWebSockets=void 0,e.sharedWebSockets={};var t=function(r){if(r&&e.sharedWebSockets.hasOwnProperty(r))delete e.sharedWebSockets[r];else for(var n in e.sharedWebSockets)e.sharedWebSockets.hasOwnProperty(n)&&delete e.sharedWebSockets[n]};e.resetWebSockets=t})(Y);var Z={},A={};Object.defineProperty(A,"__esModule",{value:!0});A.setUpSocketIOPing=A.appendQueryParams=A.parseSocketIOUrl=void 0;var J=C,Ue=function(e){if(e){var t=/^https|wss/.test(e),r=e.replace(/^(https?|wss?)(:\/\/)?/,""),n=r.replace(/\/$/,""),a=t?"wss":"ws";return"".concat(a,"://").concat(n).concat(J.SOCKET_IO_PATH)}else if(e===""){var t=/^https/.test(window.location.protocol),a=t?"wss":"ws",o=window.location.port?":".concat(window.location.port):"";return"".concat(a,"://").concat(window.location.hostname).concat(o).concat(J.SOCKET_IO_PATH)}return e};A.parseSocketIOUrl=Ue;var Re=function(e,t){t===void 0&&(t={});var r=/\?([\w]+=[\w]+)/,n=r.test(e),a="".concat(Object.entries(t).reduce(function(o,f){var d=f[0],s=f[1];return o+"".concat(d,"=").concat(s,"&")},"").slice(0,-1));return"".concat(e).concat(n?"&":"?").concat(a)};A.appendQueryParams=Re;var $e=function(e,t){t===void 0&&(t=J.SOCKET_IO_PING_INTERVAL);var r=function(){return e(J.SOCKET_IO_PING_CODE)};return window.setInterval(r,t)};A.setUpSocketIOPing=$e;var G={};Object.defineProperty(G,"__esModule",{value:!0});G.heartbeat=void 0;var ce=C;function Fe(e,t){var r=t||{},n=r.interval,a=n===void 0?ce.DEFAULT_HEARTBEAT.interval:n,o=r.timeout,f=o===void 0?ce.DEFAULT_HEARTBEAT.timeout:o,d=r.message,s=d===void 0?ce.DEFAULT_HEARTBEAT.message:d,c=!1,u=setInterval(function(){try{typeof s=="function"?e.send(s()):e.send(s)}catch{}},a),l=setInterval(function(){c?c=!1:e.close()},f);return e.addEventListener("close",function(){clearInterval(u),clearInterval(l)}),function(){c=!0}}G.heartbeat=Fe;var M={},q={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.resetSubscribers=e.removeSubscriber=e.addSubscriber=e.hasSubscribers=e.getSubscribers=void 0;var t={},r=[],n=function(s){return(0,e.hasSubscribers)(s)?Array.from(t[s]):r};e.getSubscribers=n;var a=function(s){var c;return((c=t[s])===null||c===void 0?void 0:c.size)>0};e.hasSubscribers=a;var o=function(s,c){t[s]=t[s]||new Set,t[s].add(c)};e.addSubscriber=o;var f=function(s,c){t[s].delete(c)};e.removeSubscriber=f;var d=function(s){if(s&&t.hasOwnProperty(s))delete t[s];else for(var c in t)t.hasOwnProperty(c)&&delete t[c]};e.resetSubscribers=d})(q);Object.defineProperty(M,"__esModule",{value:!0});M.resetGlobalState=M.assertIsWebSocket=void 0;var Ge=Y,He=q;function Je(e,t){if(!t&&!(e instanceof WebSocket))throw new Error("")}M.assertIsWebSocket=Je;function Be(e){(0,He.resetSubscribers)(e),(0,Ge.resetWebSockets)(e)}M.resetGlobalState=Be;var B=h&&h.__assign||function(){return B=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},B.apply(this,arguments)};Object.defineProperty(Z,"__esModule",{value:!0});Z.attachListeners=void 0;var Ve=A,Ke=G,w=C,ze=M,Qe=function(e,t,r){var n;if(t.current.heartbeat&&e instanceof WebSocket){var a=typeof t.current.heartbeat=="boolean"?void 0:t.current.heartbeat;n=(0,Ke.heartbeat)(e,a)}e.onmessage=function(o){var f;n==null||n(),t.current.onMessage&&t.current.onMessage(o),!(typeof t.current.filter=="function"&&t.current.filter(o)!==!0)&&(t.current.heartbeat&&typeof t.current.heartbeat!="boolean"&&((f=t.current.heartbeat)===null||f===void 0?void 0:f.returnMessage)===o.data||r(o))}},Ye=function(e,t,r,n){e.onopen=function(a){t.current.onOpen&&t.current.onOpen(a),n.current=0,r(w.ReadyState.OPEN)}},Ze=function(e,t,r,n,a){if(w.isEventSourceSupported&&e instanceof EventSource)return function(){};(0,ze.assertIsWebSocket)(e,t.current.skipAssert);var o;return e.onclose=function(f){var d;if(t.current.onClose&&t.current.onClose(f),r(w.ReadyState.CLOSED),t.current.shouldReconnect&&t.current.shouldReconnect(f)){var s=(d=t.current.reconnectAttempts)!==null&&d!==void 0?d:w.DEFAULT_RECONNECT_LIMIT;if(a.current<s){var c=typeof t.current.reconnectInterval=="function"?t.current.reconnectInterval(a.current):t.current.reconnectInterval;o=window.setTimeout(function(){a.current++,n()},c??w.DEFAULT_RECONNECT_INTERVAL_MS)}else t.current.onReconnectStop&&t.current.onReconnectStop(s),console.warn("Max reconnect attempts of ".concat(s," exceeded"))}},function(){return o&&window.clearTimeout(o)}},qe=function(e,t,r,n,a){var o;return e.onerror=function(f){var d;if(t.current.onError&&t.current.onError(f),w.isEventSourceSupported&&e instanceof EventSource&&(t.current.onClose&&t.current.onClose(B(B({},f),{code:1006,reason:"An error occurred with the EventSource: ".concat(f),wasClean:!1})),r(w.ReadyState.CLOSED),e.close()),t.current.retryOnError)if(a.current<((d=t.current.reconnectAttempts)!==null&&d!==void 0?d:w.DEFAULT_RECONNECT_LIMIT)){var s=typeof t.current.reconnectInterval=="function"?t.current.reconnectInterval(a.current):t.current.reconnectInterval;o=window.setTimeout(function(){a.current++,n()},s??w.DEFAULT_RECONNECT_INTERVAL_MS)}else t.current.onReconnectStop&&t.current.onReconnectStop(t.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(t.current.reconnectAttempts," exceeded"))},function(){return o&&window.clearTimeout(o)}},Xe=function(e,t,r,n,a,o){var f=t.setLastMessage,d=t.setReadyState,s,c,u;return r.current.fromSocketIO&&(s=(0,Ve.setUpSocketIOPing)(o)),Qe(e,r,f),Ye(e,r,d,a),c=Ze(e,r,d,n,a),u=qe(e,r,d,n,a),function(){d(w.ReadyState.CLOSING),c(),u(),e.close(),s&&clearInterval(s)}};Z.attachListeners=Xe;var X={},V=h&&h.__assign||function(){return V=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},V.apply(this,arguments)};Object.defineProperty(X,"__esModule",{value:!0});X.attachSharedListeners=void 0;var xe=Y,P=C,F=q,et=A,tt=G,rt=function(e,t,r){var n;r&&e instanceof WebSocket&&(n=(0,tt.heartbeat)(e,typeof r=="boolean"?void 0:r)),e.onmessage=function(a){n==null||n(),(0,F.getSubscribers)(t).forEach(function(o){o.optionsRef.current.onMessage&&o.optionsRef.current.onMessage(a),!(typeof o.optionsRef.current.filter=="function"&&o.optionsRef.current.filter(a)!==!0)&&(r&&typeof r!="boolean"&&(r==null?void 0:r.returnMessage)===a.data||o.setLastMessage(a))})}},nt=function(e,t){e.onopen=function(r){(0,F.getSubscribers)(t).forEach(function(n){n.reconnectCount.current=0,n.optionsRef.current.onOpen&&n.optionsRef.current.onOpen(r),n.setReadyState(P.ReadyState.OPEN)})}},at=function(e,t){e instanceof WebSocket&&(e.onclose=function(r){(0,F.getSubscribers)(t).forEach(function(n){n.optionsRef.current.onClose&&n.optionsRef.current.onClose(r),n.setReadyState(P.ReadyState.CLOSED)}),delete xe.sharedWebSockets[t],(0,F.getSubscribers)(t).forEach(function(n){var a;if(n.optionsRef.current.shouldReconnect&&n.optionsRef.current.shouldReconnect(r)){var o=(a=n.optionsRef.current.reconnectAttempts)!==null&&a!==void 0?a:P.DEFAULT_RECONNECT_LIMIT;if(n.reconnectCount.current<o){var f=typeof n.optionsRef.current.reconnectInterval=="function"?n.optionsRef.current.reconnectInterval(n.reconnectCount.current):n.optionsRef.current.reconnectInterval;setTimeout(function(){n.reconnectCount.current++,n.reconnect.current()},f??P.DEFAULT_RECONNECT_INTERVAL_MS)}else n.optionsRef.current.onReconnectStop&&n.optionsRef.current.onReconnectStop(n.optionsRef.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(o," exceeded"))}})})},ct=function(e,t){e.onerror=function(r){(0,F.getSubscribers)(t).forEach(function(n){n.optionsRef.current.onError&&n.optionsRef.current.onError(r),P.isEventSourceSupported&&e instanceof EventSource&&(n.optionsRef.current.onClose&&n.optionsRef.current.onClose(V(V({},r),{code:1006,reason:"An error occurred with the EventSource: ".concat(r),wasClean:!1})),n.setReadyState(P.ReadyState.CLOSED))}),P.isEventSourceSupported&&e instanceof EventSource&&e.close()}},ot=function(e,t,r,n){var a;return r.current.fromSocketIO&&(a=(0,et.setUpSocketIOPing)(n)),rt(e,t,r.current.heartbeat),at(e,t),nt(e,t),ct(e,t),function(){a&&clearInterval(a)}};X.attachSharedListeners=ot;Object.defineProperty(Q,"__esModule",{value:!0});Q.createOrJoinSocket=void 0;var I=Y,$=C,ut=Z,st=X,se=q,it=function(e,t,r,n,a){return function(){if((0,se.removeSubscriber)(e,t),!(0,se.hasSubscribers)(e)){try{var o=I.sharedWebSockets[e];o instanceof WebSocket&&(o.onclose=function(f){r.current.onClose&&r.current.onClose(f),n($.ReadyState.CLOSED)}),o.close()}catch{}a&&a(),delete I.sharedWebSockets[e]}}},lt=function(e,t,r,n,a,o,f,d){if(!$.isEventSourceSupported&&n.current.eventSourceOptions)throw $.isReactNative?new Error("EventSource is not supported in ReactNative"):new Error("EventSource is not supported");if(n.current.share){var s=null;I.sharedWebSockets[t]===void 0?(I.sharedWebSockets[t]=n.current.eventSourceOptions?new EventSource(t,n.current.eventSourceOptions):new WebSocket(t,n.current.protocols),e.current=I.sharedWebSockets[t],r($.ReadyState.CONNECTING),s=(0,st.attachSharedListeners)(I.sharedWebSockets[t],t,n,d)):(e.current=I.sharedWebSockets[t],r(I.sharedWebSockets[t].readyState));var c={setLastMessage:a,setReadyState:r,optionsRef:n,reconnectCount:f,reconnect:o};return(0,se.addSubscriber)(t,c),it(t,c,n,r,s)}else{if(e.current=n.current.eventSourceOptions?new EventSource(t,n.current.eventSourceOptions):new WebSocket(t,n.current.protocols),r($.ReadyState.CONNECTING),!e.current)throw new Error("WebSocket failed to be created");return(0,ut.attachListeners)(e.current,{setLastMessage:a,setReadyState:r},n,o.current,f,d)}};Q.createOrJoinSocket=lt;var Oe={};(function(e){var t=h&&h.__awaiter||function(d,s,c,u){function l(i){return i instanceof c?i:new c(function(_){_(i)})}return new(c||(c=Promise))(function(i,_){function S(O){try{v(u.next(O))}catch(m){_(m)}}function E(O){try{v(u.throw(O))}catch(m){_(m)}}function v(O){O.done?i(O.value):l(O.value).then(S,E)}v((u=u.apply(d,s||[])).next())})},r=h&&h.__generator||function(d,s){var c={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},u,l,i,_;return _={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function S(v){return function(O){return E([v,O])}}function E(v){if(u)throw new TypeError("Generator is already executing.");for(;c;)try{if(u=1,l&&(i=v[0]&2?l.return:v[0]?l.throw||((i=l.return)&&i.call(l),0):l.next)&&!(i=i.call(l,v[1])).done)return i;switch(l=0,i&&(v=[v[0]&2,i.value]),v[0]){case 0:case 1:i=v;break;case 4:return c.label++,{value:v[1],done:!1};case 5:c.label++,l=v[1],v=[0];continue;case 7:v=c.ops.pop(),c.trys.pop();continue;default:if(i=c.trys,!(i=i.length>0&&i[i.length-1])&&(v[0]===6||v[0]===2)){c=0;continue}if(v[0]===3&&(!i||v[1]>i[0]&&v[1]<i[3])){c.label=v[1];break}if(v[0]===6&&c.label<i[1]){c.label=i[1],i=v;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(v);break}i[2]&&c.ops.pop(),c.trys.pop();continue}v=s.call(d,c)}catch(O){v=[6,O],l=0}finally{u=i=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.getUrl=void 0;var n=A,a=C,o=function(d){return new Promise(function(s){return window.setTimeout(s,d)})},f=function(d,s,c){return c===void 0&&(c=0),t(void 0,void 0,void 0,function(){var u,l,i,_,S,E,v,O;return r(this,function(m){switch(m.label){case 0:if(typeof d!="function")return[3,10];m.label=1;case 1:return m.trys.push([1,3,,9]),[4,d()];case 2:return u=m.sent(),[3,9];case 3:return m.sent(),s.current.retryOnError?(l=(E=s.current.reconnectAttempts)!==null&&E!==void 0?E:a.DEFAULT_RECONNECT_LIMIT,c<l?(i=typeof s.current.reconnectInterval=="function"?s.current.reconnectInterval(c):s.current.reconnectInterval,[4,o(i??a.DEFAULT_RECONNECT_INTERVAL_MS)]):[3,5]):[3,7];case 4:return m.sent(),[2,(0,e.getUrl)(d,s,c+1)];case 5:return(O=(v=s.current).onReconnectStop)===null||O===void 0||O.call(v,c),[2,null];case 6:return[3,8];case 7:return[2,null];case 8:return[3,9];case 9:return[3,11];case 10:u=d,m.label=11;case 11:return _=s.current.fromSocketIO?(0,n.parseSocketIOUrl)(u):u,S=s.current.queryParams?(0,n.appendQueryParams)(_,s.current.queryParams):_,[2,S]}})})};e.getUrl=f})(Oe);var ge={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.websocketWrapper=void 0;var t=function(r,n){return new Proxy(r,{get:function(a,o){var f=a[o];return o==="reconnect"?n:typeof f=="function"?(console.error("Calling methods directly on the websocket is not supported at this moment. You must use the methods returned by useWebSocket."),function(){}):f},set:function(a,o,f){return/^on/.test(o)?(console.warn("The websocket's event handlers should be defined through the options object passed into useWebSocket."),!1):(a[o]=f,!0)}})};e.websocketWrapper=t,e.default=e.websocketWrapper})(ge);var k=h&&h.__assign||function(){return k=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},k.apply(this,arguments)},ft=h&&h.__awaiter||function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(f){f(o)})}return new(r||(r=Promise))(function(o,f){function d(u){try{c(n.next(u))}catch(l){f(l)}}function s(u){try{c(n.throw(u))}catch(l){f(l)}}function c(u){u.done?o(u.value):a(u.value).then(d,s)}c((n=n.apply(e,t||[])).next())})},dt=h&&h.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,f;return f={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function d(c){return function(u){return s([c,u])}}function s(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(o=c[0]&2?a.return:c[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,c[1])).done)return o;switch(a=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,a=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(c[0]===6&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],a=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},vt=h&&h.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(U,"__esModule",{value:!0});U.useWebSocket=void 0;var y=N,oe=Ne,p=C,St=Q,_t=Oe,Et=vt(ge),Se=M,ht=function(e,t,r){t===void 0&&(t=p.DEFAULT_OPTIONS),r===void 0&&(r=!0);var n=(0,y.useState)(null),a=n[0],o=n[1],f=(0,y.useState)({}),d=f[0],s=f[1],c=(0,y.useMemo)(function(){if(a)try{return JSON.parse(a.data)}catch{return p.UNPARSABLE_JSON_OBJECT}return null},[a]),u=(0,y.useRef)(null),l=(0,y.useRef)(null),i=(0,y.useRef)(function(){}),_=(0,y.useRef)(0),S=(0,y.useRef)([]),E=(0,y.useRef)(null),v=(0,y.useRef)(t);v.current=t;var O=u.current&&d[u.current]!==void 0?d[u.current]:e!==null&&r===!0?p.ReadyState.CONNECTING:p.ReadyState.UNINSTANTIATED,m=t.queryParams?JSON.stringify(t.queryParams):null,D=(0,y.useCallback)(function(g,T){var L;if(T===void 0&&(T=!0),p.isEventSourceSupported&&l.current instanceof EventSource){console.warn("Unable to send a message from an eventSource");return}((L=l.current)===null||L===void 0?void 0:L.readyState)===p.ReadyState.OPEN?((0,Se.assertIsWebSocket)(l.current,v.current.skipAssert),l.current.send(g)):T&&S.current.push(g)},[]),ye=(0,y.useCallback)(function(g,T){T===void 0&&(T=!0),D(JSON.stringify(g),T)},[D]),me=(0,y.useCallback)(function(){return v.current.share!==!0||p.isEventSourceSupported&&l.current instanceof EventSource?l.current:(E.current===null&&l.current&&((0,Se.assertIsWebSocket)(l.current,v.current.skipAssert),E.current=(0,Et.default)(l.current,i)),E.current)},[]);return(0,y.useEffect)(function(){if(e!==null&&r===!0){var g,T=!1,L=!0,ie=function(){return ft(void 0,void 0,void 0,function(){var H,j,le;return dt(this,function(fe){switch(fe.label){case 0:return H=u,[4,(0,_t.getUrl)(e,v)];case 1:return H.current=fe.sent(),u.current===null?(console.error("Failed to get a valid URL. WebSocket connection aborted."),u.current="ABORTED",(0,oe.flushSync)(function(){return s(function(R){return k(k({},R),{ABORTED:p.ReadyState.CLOSED})})}),[2]):(j=function(R){T||(0,oe.flushSync)(function(){return o(R)})},le=function(R){T||(0,oe.flushSync)(function(){return s(function(Te){var te;return k(k({},Te),u.current&&(te={},te[u.current]=R,te))})})},L&&(g=(0,St.createOrJoinSocket)(l,u.current,le,v,j,i,_,D)),[2])}})})};return i.current=function(){T||(E.current&&(E.current=null),g==null||g(),ie())},ie(),function(){T=!0,L=!1,E.current&&(E.current=null),g==null||g(),o(null)}}else(e===null||r===!1)&&(_.current=0,s(function(H){var j;return k(k({},H),u.current&&(j={},j[u.current]=p.ReadyState.CLOSED,j))}))},[e,r,m,D]),(0,y.useEffect)(function(){O===p.ReadyState.OPEN&&S.current.splice(0).forEach(function(g){D(g)})},[O]),{sendMessage:D,sendJsonMessage:ye,lastMessage:a,lastJsonMessage:c,readyState:O,getWebSocket:me}};U.useWebSocket=ht;var x={},K=h&&h.__assign||function(){return K=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},K.apply(this,arguments)};Object.defineProperty(x,"__esModule",{value:!0});x.useSocketIO=void 0;var _e=N,bt=U,Ot=C,ue={type:"empty",payload:null},gt=function(e){if(!e||!e.data)return ue;var t=e.data.match(/\[.*]/);if(!t)return ue;var r=JSON.parse(t);return!Array.isArray(r)||!r[1]?ue:{type:r[0],payload:r[1]}},yt=function(e,t,r){t===void 0&&(t=Ot.DEFAULT_OPTIONS),r===void 0&&(r=!0);var n=(0,_e.useMemo)(function(){return K(K({},t),{fromSocketIO:!0})},[]),a=(0,bt.useWebSocket)(e,n,r),o=a.sendMessage,f=a.sendJsonMessage,d=a.lastMessage,s=a.readyState,c=a.getWebSocket,u=(0,_e.useMemo)(function(){return gt(d)},[d]);return{sendMessage:o,sendJsonMessage:f,lastMessage:u,lastJsonMessage:u,readyState:s,getWebSocket:c}};x.useSocketIO=yt;var ee={},z=h&&h.__assign||function(){return z=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},z.apply(this,arguments)},mt=h&&h.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};Object.defineProperty(ee,"__esModule",{value:!0});ee.useEventSource=void 0;var Ee=N,Tt=U,he=C,Nt=function(e,t,r){t===void 0&&(t=he.DEFAULT_EVENT_SOURCE_OPTIONS);var n=t.withCredentials,a=t.events,o=mt(t,["withCredentials","events"]);r===void 0&&(r=!0);var f=z(z({},o),{eventSourceOptions:{withCredentials:n}}),d=(0,Ee.useRef)(he.EMPTY_EVENT_HANDLERS);a&&(d.current=a);var s=(0,Tt.useWebSocket)(e,f,r),c=s.lastMessage,u=s.readyState,l=s.getWebSocket;return(0,Ee.useEffect)(function(){c!=null&&c.type&&Object.entries(d.current).forEach(function(i){var _=i[0],S=i[1];_===c.type&&S(c)})},[c]),{lastEvent:c,readyState:u,getEventSource:l}};ee.useEventSource=Nt;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.resetGlobalState=e.useEventSource=e.ReadyState=e.useSocketIO=e.default=void 0;var t=U;Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.useWebSocket}});var r=x;Object.defineProperty(e,"useSocketIO",{enumerable:!0,get:function(){return r.useSocketIO}});var n=C;Object.defineProperty(e,"ReadyState",{enumerable:!0,get:function(){return n.ReadyState}});var a=ee;Object.defineProperty(e,"useEventSource",{enumerable:!0,get:function(){return a.useEventSource}});var o=M;Object.defineProperty(e,"resetGlobalState",{enumerable:!0,get:function(){return o.resetGlobalState}})})(be);const Ct=Ce(be),kt=()=>{const{id:e}=pe(),t=we(),r=Ae(u=>Ie(u,e)),n=N.useRef(r),[a,o]=N.useState(5),{sendMessage:f,lastMessage:d,readyState:s}=Ct(`${ke}`,{onOpen:()=>console.log("WebSocket connection established"),onClose:()=>console.log("WebSocket connection closed"),onError:u=>console.error("WebSocket error:",u),shouldReconnect:u=>!0});N.useEffect(()=>{async function u(){try{const l=await de.get(`${ve}/api/zone-records`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(l.data){console.log(l.data,"ZONE DATA");const i=l.data.data.reduce((_,S)=>{const E=_.find(v=>v.defect_name===S.defect_name&&v.station_id===S.station_id&&v.screen_no===S.screen_no);return E?E.count=(E.count||1)+1:_.push({id:S.id,defect_name:S.defect_name,station_id:S.station_id,screen_no:S.screen_no,operator_name:S.operator_name,updated_at:S.updated_at,count:1,is_updated:!1}),_},[]);console.log(i,"FORMATTED DATA"),t(re(i))}else toast.error("Failed to fetch zone records")}catch(l){console.error("Error fetching zone records:",l),toast.error("Failed to fetch zone records")}}u()},[]),N.useEffect(()=>{e&&console.log("Zone ID:",e)},[e]),N.useEffect(()=>{(async()=>{try{const l=await de.get(`${ve}/settings/alert_timer`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});l.status===200?(sessionStorage.setItem("alert_timer",l.data.alert_timer),o(l.data.alert_timer)):toast.error("Failed to fetch alert timer value")}catch(l){console.error("Error fetching alert timer:",l),toast.error("Failed to fetch alert timer value")}})()},[]),N.useEffect(()=>{if(d!==null){console.log("Received message:",d.data);try{const u=JSON.parse(d.data);if(console.log("Parsed message:",u),u.defect){const l=new Map;u.operators.forEach(S=>{l.set(S.station_id,S.operator_name)});const i=u.defects.map(S=>({...S,operator_name:l.get(S.station_id)||"Unknown Operator",updated_at:u.updated_at}));console.log(i,"updated defect 1",r,[...r,...i]),localStorage.setItem("active_clients",u.active_clients||0);const _=[...r,...i];console.log(_,"SOCKET DATA"),t(re(_))}}catch(u){console.error("Error parsing message:",u)}}},[d]);const c=N.useMemo(()=>{const u=new Map;return r.forEach(i=>{const _=n.current.find(E=>E.id===i.id),S=_?_.count!==i.count:!0;u.set(i.id,{...i,is_updated:S})}),console.log(Array.from(u.values())),Array.from(u.values()).sort((i,_)=>{const S=new Date(i.updated_at);return new Date(_.updated_at)-S})},[r,n]);return N.useEffect(()=>{n.current=r},[r]),N.useEffect(()=>{c.forEach(u=>{if(u.is_updated){const l=setTimeout(()=>{t(re(r.map(i=>i.id===u.id?{...i,is_updated:!1}:i)))},parseInt(a)*1e3||5e3);return()=>clearTimeout(l)}})},[c,t]),b.jsxs("div",{className:"con",children:[b.jsxs("h2",{style:{textAlign:"center",marginBottom:"20px"},children:["Engine Assembly Line Defect Monitoring System - Zone ",e||"-"]}),b.jsx(De,{className:"g-4",children:c.length>0&&c.map((u,l)=>b.jsx(Le,{xs:12,sm:6,md:4,lg:3,xl:2,children:b.jsx(Me,{className:`defect-card ${u.is_updated?"updated":""}`,style:u.is_updated?{animationDuration:`${a}s`}:{},children:b.jsx(Pe,{children:b.jsx(je,{children:b.jsxs(We,{children:[b.jsxs(ne,{children:[b.jsx(ae,{scope:"row",children:"Defect Name"}),b.jsx(ae,{scope:"row",children:"Operator Name"}),b.jsx(ae,{scope:"row",children:"Count"})]}),b.jsxs(ne,{children:[b.jsx(W,{children:u.defect_name}),b.jsx(W,{children:u.operator_name}),b.jsx(W,{children:u.count||1})]}),b.jsxs(ne,{children:[b.jsx(W,{children:u.defect_name}),b.jsx(W,{children:u.operator_name}),b.jsx(W,{children:u.count||1})]})]})})})})},l))})]})};export{kt as default};
